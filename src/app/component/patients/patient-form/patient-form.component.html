<mat-card class="patient-card">
  <mat-card-header>
    <mat-card-title>ADD NEW PATIENT</mat-card-title>
    <mat-card-subtitle>Enter patient information to create a new record</mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <div class="info-section">
      <div class="form-row">
        <div class="form-group">
          <h3><mat-icon>person</mat-icon> Personal Information</h3>
          <mat-form-field appearance="outline">
            <mat-label>Name</mat-label>
            <input matInput [(ngModel)]="patient.name">
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>CIN</mat-label>
            <input matInput [(ngModel)]="patient.cin">
          </mat-form-field>
          <mat-form-field appearance="outline" class="age-field">
            <mat-label>Age</mat-label>
            <input matInput type="number" [(ngModel)]="patient.age" min="0" max="150">
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Gender</mat-label>
            <mat-select [(ngModel)]="patient.gender">
              <mat-option value="male">Male</mat-option>
              <mat-option value="female">Female</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <div class="form-group">
          <h3><mat-icon>phone</mat-icon> Contact Information</h3>
          <mat-form-field appearance="outline">
            <mat-label>Phone</mat-label>
            <input matInput [(ngModel)]="patient.phone">
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Email</mat-label>
            <input matInput type="email" [(ngModel)]="patient.email">
          </mat-form-field>
        </div>

        <div class="form-group">
          <h3><mat-icon>medical_services</mat-icon> Medical Information</h3>
          <mat-form-field appearance="outline">
            <mat-label>Status</mat-label>
            <mat-select [(ngModel)]="patient.status">
              <mat-option value="active">Active</mat-option>
              <mat-option value="inactive">Inactive</mat-option>
            </mat-select>
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Disease</mat-label>
            <input matInput [(ngModel)]="patient.disease">
          </mat-form-field>
          <mat-form-field appearance="outline">
            <mat-label>Insurance</mat-label>
            <input matInput [(ngModel)]="patient.insurance">
          </mat-form-field>
        </div>
      </div>
    </div>

    <div class="documents-section">
      <h3><mat-icon>description</mat-icon> Documents</h3>
      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>Add New Document</mat-label>
          <input matInput [(ngModel)]="newDocument" placeholder="Enter document name">
          <button mat-icon-button matSuffix (click)="addDocument()">
            <mat-icon>add</mat-icon>
          </button>
        </mat-form-field>
      </div>
      <div class="documents-list">
        <ul *ngIf="patient.documents && patient.documents.length > 0">
          <li *ngFor="let doc of patient.documents" class="document-item">
            <mat-icon>insert_drive_file</mat-icon> {{ doc }}
          </li>
        </ul>
        <p *ngIf="!patient.documents || patient.documents.length === 0" class="no-items">No documents available.</p>
      </div>
    </div>

    <div class="medical-history-section">
      <h3><mat-icon>history</mat-icon> Medical History</h3>
      <div class="form-group">
        <mat-form-field appearance="outline">
          <mat-label>Add New Medical History</mat-label>
          <input matInput [(ngModel)]="newMedicalHistory" placeholder="Enter medical history">
          <button mat-icon-button matSuffix (click)="addMedicalHistory()">
            <mat-icon>add</mat-icon>
          </button>
        </mat-form-field>
      </div>
      <div class="history-list">
        <ul *ngIf="patient.medicalHistory && patient.medicalHistory.length > 0">
          <li *ngFor="let history of patient.medicalHistory" class="history-item">
            <mat-icon>event_note</mat-icon> {{ history }}
          </li>
        </ul>
        <p *ngIf="!patient.medicalHistory || patient.medicalHistory.length === 0" class="no-items">No medical history available.</p>
      </div>
    </div>
  </mat-card-content>

  <mat-card-actions>
    <div class="button-container">
      <button mat-raised-button color="primary" (click)="savePatient()">
        <mat-icon>person_add</mat-icon> Add Patient
      </button>
      <button mat-button (click)="cancel()">
        <mat-icon>close</mat-icon> Cancel
      </button>
    </div>
  </mat-card-actions>
</mat-card>

<div *ngIf="isLoading" class="loading-container">
  <mat-spinner diameter="40"></mat-spinner>
  <p>Adding new patient...</p>
</div>

<div *ngIf="errorMessage" class="error-message">
  <mat-icon>error_outline</mat-icon> {{ errorMessage }}
</div>